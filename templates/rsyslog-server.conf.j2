
module(load="imuxsock")
module(load="imklog")

module(load="imudp")
input(type="imudp" port="514")

$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat
$FileOwner root
$FileGroup adm
$FileCreateMode 0640
$DirCreateMode 0755
$Umask 0022
$WorkDirectory /var/spool/rsyslog
$IncludeConfig /etc/rsyslog.d/*.conf

$template   Rkern,"/var/log/%HOSTNAME%/kern.log"
$template   Ruser,"/var/log/%HOSTNAME%/user.log"
$template   Rmail,"/var/log/%HOSTNAME%/mail.log"
$template   Rdaemon,"/var/log/%HOSTNAME%/daemon.log"
$template   Rauth,"/var/log/%HOSTNAME%/auth.log"
$template   Rsyslog,"/var/log/%HOSTNAME%/syslog.log"
$template   Rlpr,"/var/log/%HOSTNAME%/lpr.log"
$template   Rnews,"/var/log/%HOSTNAME%/news.log"
$template   Rcron,"/var/log/%HOSTNAME%/cron.log"

kern.*                  ?Rkern
user.*                  ?Ruser
mail.*                  ?Rmail
daemon.*                ?Rdaemon
auth,authpriv.*			?Rauth
syslog.*                ?Rsyslog
lpr.*                   ?Rlpr
news.*                  ?Rnews
cron.*                  ?Rcron
